# XV-NET Generated BIRD Configuration for <% $HOSTNAME %>

http local {
	endpoints { "/dns-query"; };
};

options {
	directory "/var/run/bind";

	listen-on { any; };
	listen-on-v6 { any; };
	# listen-on port 853 tls ephemeral { any; };
	# listen-on-v6 port 853 tls ephemeral { any; };
	# listen-on port 453 tls none http local { any; };
	# listen-on-v6 port 453 tls none http local { any; };

	pid-file "/var/run/bind/named.pid";

	allow-transfer { none; };

	validate-except {
		# DN42
		"dn42";
		"20.172.in-addr.arpa";
		"21.172.in-addr.arpa";
		"22.172.in-addr.arpa";
		"23.172.in-addr.arpa";
		"10.in-addr.arpa";
		"d.f.ip6.arpa";
	};
};

view "recursion" {
	match-destinations {
		172.20.206.65;
		fd00:443a:ef14:0000:0000:0000:0001::/112;
	};

	match-recursive-only yes;
	recursion yes;
	forward first;
	forwarders {
		# Quad 9
		2620:fe::fe;
		9.9.9.9;

		# OpenNIC
		37.252.191.197; # ns1.at.dns.opennic.glue
		2a00:63c1:10:197::2; # ns1.at.dns.opennic.glue
		80.78.132.79; # ns1.nl.dns.opennic.glue
		2a0d:2146:2404::1069; # ns1.nl.dns.opennic.glue

		# 1.1.1.1
		2606:4700:4700::1111;
		1.1.1.1;
	};

	.INCLUDE services/bind/conf/dn42.conf

	dnssec-validation yes;
	empty-zones-enable no;
};
